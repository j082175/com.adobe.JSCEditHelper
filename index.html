<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JSCEditHelper</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="content">
        <!-- í—¤ë” ì„¹ì…˜ -->
        <header class="app-header">
            <h1>ğŸ¬ JSCEditHelper</h1>
            <p class="app-subtitle">Premiere Pro í¸ì§‘ íš¨ìœ¨ì„± ë„êµ¬</p>
        </header>

        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="tabs-navigation">
            <button class="tab-button active" data-tab="clip">ğŸ§² í´ë¦½ ì •ë ¬</button>
            <button class="tab-button" data-tab="sound">ğŸµ íš¨ê³¼ìŒ</button>
            <button class="tab-button" data-tab="image">ğŸ¬ ì´ë¯¸ì§€ ë§¤ì¹­</button>
            <button class="tab-button" data-tab="dev">ğŸ› ï¸ ê°œë°œì</button>
        </div>

        <!-- íƒ­ 1: í´ë¦½ ì •ë ¬ -->
        <div class="tab-content active" id="tab-clip">
            <div class="quick-actions">
            <div class="action-card primary-card">
                <div class="card-header">
                    <h2>ğŸ§² í´ë¦½ ìë™ ì •ë ¬</h2>
                    <span class="shortcut-badge">Ctrl+Shift+M</span>
                </div>
                <p class="card-description">í´ë¦½ ì‚¬ì´ ë¹ˆ ê³µê°„ ì œê±°</p>
                <button id="magnetClips" class="btn-primary">ì •ë ¬ ì‹¤í–‰</button>
                <div id="magnetStatus" class="status-indicator"></div>
            </div>
            </div>
        </div>

        <!-- íƒ­ 2: íš¨ê³¼ìŒ -->
        <div class="tab-content" id="tab-sound">

        <!-- íš¨ê³¼ìŒ ê´€ë¦¬ ì„¹ì…˜ -->
        <div class="workflow-section">
            <div class="section-header">
                <h2>ğŸµ íš¨ê³¼ìŒ ì›Œí¬í”Œë¡œìš°</h2>
                <button class="btn-collapse" data-target="sound-workflow">
                    <span class="collapse-icon">âˆ’</span>
                </button>
            </div>
            
            <div id="sound-workflow" class="workflow-content">
                <!-- í´ë” ì„¤ì • ì¹´ë“œ -->
                <div class="action-card">
                    <div class="card-header">
                        <h3>ğŸ“ í´ë” ì„¤ì •</h3>
                        <span class="shortcut-badge">Ctrl+Shift+B</span>
                    </div>
                    <div class="input-group">
                        <input type="text" id="sound-folder" placeholder="íš¨ê³¼ìŒ í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”..." readonly>
                        <button id="browseFolder" class="btn-secondary">ì°¾ì•„ë³´ê¸°</button>
                    </div>
                    <button id="refreshSounds" class="btn-text" disabled>ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                </div>

                <!-- íš¨ê³¼ìŒ ì‚½ì… ì¹´ë“œ -->
                <div class="action-card">
                    <div class="card-header">
                        <h3>ğŸµ íš¨ê³¼ìŒ ì‚½ì…</h3>
                        <span class="shortcut-badge">Ctrl+Shift+I</span>
                    </div>
                    <div class="form-group compact">
                        <label for="audio-track">ì‚½ì… íŠ¸ë™:</label>
                    </div>
                    <div class="inline-controls">
                        <select id="audio-track" class="select-modern flex-item">
                            <option value="auto">ìë™ ì„ íƒ</option>
                            <option value="1">ì˜¤ë””ì˜¤ íŠ¸ë™ 1</option>
                            <option value="2">ì˜¤ë””ì˜¤ íŠ¸ë™ 2</option>
                            <option value="3">ì˜¤ë””ì˜¤ íŠ¸ë™ 3</option>
                        </select>
                        <button id="insert-sounds" class="btn-primary flex-item">íš¨ê³¼ìŒ ì‚½ì…</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê°œë³„ íš¨ê³¼ìŒ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
        <div class="workflow-section">
            <div class="section-header">
                <h2>ğŸ¼ íš¨ê³¼ìŒ ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>
                <button class="btn-collapse" data-target="sound-library">
                    <span class="collapse-icon">âˆ’</span>
                </button>
            </div>
            
            <div id="sound-library" class="workflow-content">
                <div class="library-status">
                    <span class="status-label">í˜„ì¬ í´ë”:</span>
                    <span id="folderPathSpan" class="folder-path">í´ë”ê°€ ì„ íƒë˜ì§€ ì•ŠìŒ</span>
                </div>
                
                <div id="individualSoundButtonsContainer" class="sound-grid">
                    <div id="soundButtonPlaceholder" class="empty-state">
                        <div class="empty-icon">ğŸµ</div>
                        <h3>íš¨ê³¼ìŒ ë¼ì´ë¸ŒëŸ¬ë¦¬</h3>
                        <p>í´ë”ë¥¼ ì„ íƒí•˜ë©´ íš¨ê³¼ìŒì´ í‘œì‹œë©ë‹ˆë‹¤</p>
                        <button class="btn-cta" onclick="document.getElementById('browseFolder').click()">
                            ğŸ“ í´ë” ì„ íƒí•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ìƒíƒœ ë° ê²°ê³¼ ì„¹ì…˜ -->
        <div class="status-section">
            <div class="status-card">
                <div id="result-info" class="status-display">
                    <div id="status-message" class="status-text">ì‹œì‘í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤</div>
                    <div class="status-indicator-dot ready"></div>
                </div>
                <div id="sound-list" class="result-list"></div>
            </div>
        </div>

        </div>

        <!-- íƒ­ 3: ì´ë¯¸ì§€ ë§¤ì¹­ -->
        <div class="tab-content" id="tab-image">

        <!-- ìº¡ì…˜-ì´ë¯¸ì§€ ë™ê¸°í™” ì„¹ì…˜ -->
        <div class="workflow-section">
            <div class="section-header">
                <h2>ğŸ¬ ìº¡ì…˜-ì´ë¯¸ì§€ ë™ê¸°í™” (Beta)</h2>
                <button class="btn-collapse" data-target="caption-image-sync">
                    <span class="collapse-icon">âˆ’</span>
                </button>
            </div>

            <div id="caption-image-sync" class="workflow-content">
                <div class="action-card">
                    <div class="card-header">
                        <h3>âš™ï¸ ë™ê¸°í™” ì˜µì…˜</h3>
                    </div>
                    <div class="form-group compact">
                        <label for="target-video-track">ì‚½ì…í•  ë¹„ë””ì˜¤ íŠ¸ë™:</label>
                        <select id="target-video-track" class="select-modern">
                            <option value="0">V1 íŠ¸ë™</option>
                            <option value="1">V2 íŠ¸ë™</option>
                            <option value="2">V3 íŠ¸ë™</option>
                            <option value="3">V4 íŠ¸ë™</option>
                        </select>
                    </div>
                    <p class="card-description" style="margin-top: 8px; font-size: 12px; color: #888;">
                        ğŸ¬ <strong>ë¹„ë””ì˜¤ ìŠ¤í‚µ:</strong> ìº¡ì…˜ ìœ„ì¹˜ì— ë¹„ë””ì˜¤ë‚˜ ì´ë¯¸ì§€ í´ë¦½ì´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ê±´ë„ˆëœë‹ˆë‹¤
                    </p>
                    <button id="sync-caption-images" class="btn-primary" disabled>ğŸ”„ ë™ê¸°í™” ì‹œì‘</button>
                </div>

                <!-- 2ë‹¨ ë ˆì´ì•„ì›ƒ: ì™¼ìª½ í…ìŠ¤íŠ¸, ì˜¤ë¥¸ìª½ ì´ë¯¸ì§€ -->
                <div class="two-column-layout">
                    <!-- ì™¼ìª½: í…ìŠ¤íŠ¸ ì…ë ¥ ì˜ì—­ -->
                    <div class="left-panel">
                        <div class="panel-header">
                            <h3>ğŸ“ í…ìŠ¤íŠ¸ ë¦¬ìŠ¤íŠ¸</h3>
                        </div>
                        <div class="text-editor-container" id="text-list-container">
                            <!-- í…ìŠ¤íŠ¸ í–‰ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </div>
                        <div class="text-info">
                            <button id="replace-all-text" class="btn-text">ğŸ“‹ ì „ì²´ êµì²´</button>
                            <span id="text-count">0ì¤„</span>
                        </div>
                    </div>

                    <!-- ì˜¤ë¥¸ìª½: ì´ë¯¸ì§€ ê·¸ë¦¬ë“œ -->
                    <div class="right-panel">
                        <div class="panel-header">
                            <h3>ğŸ–¼ï¸ ì´ë¯¸ì§€ ì¹´ë“œ</h3>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <button id="clear-all-images" class="btn-text" style="display: none;">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
                                <span id="image-count-text" style="font-size: 13px; color: #888;">0ê°œ</span>
                            </div>
                        </div>
                        <div id="image-grid" class="image-grid image-drop-zone">
                            <div class="empty-state">
                                <div class="empty-icon">ğŸ–¼ï¸</div>
                                <h3>ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•˜ì„¸ìš”</h3>
                                <p>ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë˜ëŠ” Ctrl+Vë¡œ ì¶”ê°€</p>
                            </div>
                        </div>
                    </div>
                </div>

                <p class="card-description" style="margin-top: 8px; font-size: 12px; color: #888;">
                    ğŸ’¡ íŒ: ì™¼ìª½ í…ìŠ¤íŠ¸ì™€ ì˜¤ë¥¸ìª½ ì´ë¯¸ì§€ê°€ ìˆœì„œëŒ€ë¡œ 1:1 ë§¤ì¹­ë©ë‹ˆë‹¤. ê° ì´ë¯¸ì§€ì˜ ìº¡ì…˜ ê°œìˆ˜ëŠ” ê°œë³„ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.
                </p>
            </div>
        </div>

        </div>

        <!-- íƒ­ 4: ê°œë°œì ë„êµ¬ -->
        <div class="tab-content" id="tab-dev">
            <div class="workflow-section">
                <div class="action-card">
                    <div class="card-header">
                        <h2>ğŸ› ï¸ ê°œë°œì ë„êµ¬</h2>
                    </div>
                    <p class="card-description">ë””ë²„ê¹… ë° í…ŒìŠ¤íŠ¸ ë„êµ¬</p>
                    <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 12px;">
                        <button id="test-sound-engine" class="btn-secondary">ğŸ”§ SoundEngine í…ŒìŠ¤íŠ¸</button>
                        <button id="debug-button" class="btn-secondary">ğŸ“‹ ë””ë²„ê·¸ ì •ë³´</button>
                        <button id="close-debug-button" class="btn-secondary" style="display: none;">âŒ ë””ë²„ê·¸ ë‹«ê¸°</button>
                    </div>
                    <pre id="debug-info" class="debug-output" style="margin-top: 12px;"></pre>
                </div>
            </div>
        </div>

        <!-- ì´ë¯¸ì§€ ê´€ë¦¬ ëª¨ë‹¬ -->
        <div id="image-modal" class="modal-overlay">
            <div class="modal-container">
                <div class="modal-header">
                    <h2>ğŸ¬ ì´ë¯¸ì§€ ë§¤ì¹­ ê´€ë¦¬</h2>
                    <button id="close-modal" class="modal-close-btn">âœ•</button>
                </div>
                <div class="modal-body image-drop-zone" id="modal-drop-zone">
                    <div class="modal-actions">
                        <button id="browse-images" class="btn-secondary">ğŸ“ ì´ë¯¸ì§€ ì¶”ê°€</button>
                        <button id="clear-image-queue" class="btn-text">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
                    </div>
                    <div id="image-queue" class="image-grid"></div>
                    <div class="modal-drop-hint">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ì¶”ê°€í•˜ì„¸ìš”</div>
                </div>
                <div class="modal-footer">
                    <button id="modal-done" class="btn-primary">âœ“ ì™„ë£Œ</button>
                </div>
            </div>
        </div>

        <!-- í…ìŠ¤íŠ¸ ì „ì²´ êµì²´ ëª¨ë‹¬ -->
        <div id="text-replace-modal" class="modal-overlay">
            <div class="modal-container" style="max-width: 600px;">
                <div class="modal-header">
                    <h2>ğŸ“‹ í…ìŠ¤íŠ¸ ì „ì²´ êµì²´</h2>
                    <button id="close-text-replace-modal" class="modal-close-btn">âœ•</button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 12px; color: #888; font-size: 13px;">
                        ğŸ’¡ ì—¬ëŸ¬ ì¤„ í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. ê° ì¤„ì´ ê°œë³„ í…ìŠ¤íŠ¸ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤.
                    </p>
                    <textarea id="text-replace-input"
                              placeholder="í…ìŠ¤íŠ¸ë¥¼ í•œ ì¤„ì”© ì…ë ¥í•˜ê±°ë‚˜ ë¶™ì—¬ë„£ê¸°...
1ë²ˆ ì´ë¯¸ì§€ì™€ ë§¤ì¹­ë  í…ìŠ¤íŠ¸
2ë²ˆ ì´ë¯¸ì§€ì™€ ë§¤ì¹­ë  í…ìŠ¤íŠ¸
3ë²ˆ ì´ë¯¸ì§€ì™€ ë§¤ì¹­ë  í…ìŠ¤íŠ¸"
                              style="width: 100%; min-height: 300px; background: var(--color-bg-primary); color: var(--color-text-primary); border: 1px solid #444; border-radius: 4px; padding: 12px; font-family: 'Consolas', monospace; font-size: 12px; resize: vertical;"></textarea>
                </div>
                <div class="modal-footer">
                    <button id="cancel-text-replace" class="btn-text" style="margin-right: 8px;">ì·¨ì†Œ</button>
                    <button id="confirm-text-replace" class="btn-primary">âœ“ êµì²´í•˜ê¸°</button>
                </div>
            </div>
        </div>
    </div>

    <script src="lib/CSInterface.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/di-helpers.js"></script>
    <script src="js/error-handler.js"></script>
    <!-- <script src="js/validation.js"></script> ì‹¤ìš©ì„±ì„ ìœ„í•´ ë¹„í™œì„±í™” -->
    <script src="js/ui-manager.js"></script>
    <script src="js/state-manager.js"></script>
    <script src="js/communication.js"></script>
    
    <!-- TypeScript ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—”ì§„ë“¤ -->
    <script src="js/audio-file-processor.js"></script>
    <script src="js/clip-time-calculator.js"></script>
    <script src="js/audio-preview-manager.js"></script>
    <script src="js/sound-engine.js"></script>
    
    <script src="js/event-manager.js"></script>
    <script src="js/app.js"></script>
    
    <!-- UI ì¸í„°ë™ì…˜ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // íƒ­ ì „í™˜ ê¸°ëŠ¥
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = button.dataset.tab;

                    // ëª¨ë“  íƒ­ ë²„íŠ¼ê³¼ ì»¨í…ì¸ ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));

                    // í´ë¦­ëœ íƒ­ ë²„íŠ¼ê³¼ í•´ë‹¹ ì»¨í…ì¸ ì— active í´ë˜ìŠ¤ ì¶”ê°€
                    button.classList.add('active');
                    document.getElementById('tab-' + targetTab).classList.add('active');
                });
            });

            // ì ‘ê¸°/í´ê¸° ê¸°ëŠ¥
            const collapseButtons = document.querySelectorAll('.btn-collapse');

            collapseButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetId = button.dataset.target;
                    const target = document.getElementById(targetId);
                    const icon = button.querySelector('.collapse-icon');

                    if (target) {
                        const isVisible = target.style.display !== 'none';
                        target.style.display = isVisible ? 'none' : 'block';
                        icon.textContent = isVisible ? '+' : 'âˆ’';
                    }
                });
            });

            // ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸° ê¸°ëŠ¥
            const modal = document.getElementById('image-modal');
            const openModalBtn = document.getElementById('open-image-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const doneBtn = document.getElementById('modal-done');

            function openModal() {
                modal.classList.add('active');
            }

            function closeModal() {
                modal.classList.remove('active');
            }

            if (openModalBtn) {
                openModalBtn.addEventListener('click', openModal);
            }

            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', closeModal);
            }

            if (doneBtn) {
                doneBtn.addEventListener('click', closeModal);
            }

            // ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ë‹«ê¸°
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal();
                }
            });

            // ESC í‚¤ë¡œ ë‹«ê¸°
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.classList.contains('active')) {
                    closeModal();
                }
            });

            // í…ìŠ¤íŠ¸ êµì²´ ëª¨ë‹¬
            const textReplaceModal = document.getElementById('text-replace-modal');
            const closeTextReplaceBtn = document.getElementById('close-text-replace-modal');
            const cancelTextReplaceBtn = document.getElementById('cancel-text-replace');
            const confirmTextReplaceBtn = document.getElementById('confirm-text-replace');

            if (closeTextReplaceBtn) {
                closeTextReplaceBtn.addEventListener('click', function() {
                    if (window.JSCEventManager && window.JSCEventManager.closeTextReplaceModal) {
                        window.JSCEventManager.closeTextReplaceModal();
                    }
                });
            }

            if (cancelTextReplaceBtn) {
                cancelTextReplaceBtn.addEventListener('click', function() {
                    if (window.JSCEventManager && window.JSCEventManager.closeTextReplaceModal) {
                        window.JSCEventManager.closeTextReplaceModal();
                    }
                });
            }

            if (confirmTextReplaceBtn) {
                confirmTextReplaceBtn.addEventListener('click', function() {
                    if (window.JSCEventManager && window.JSCEventManager.executeTextReplace) {
                        window.JSCEventManager.executeTextReplace();
                    }
                });
            }

            // í…ìŠ¤íŠ¸ êµì²´ ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ë‹«ê¸°
            if (textReplaceModal) {
                textReplaceModal.addEventListener('click', function(e) {
                    if (e.target === textReplaceModal) {
                        if (window.JSCEventManager && window.JSCEventManager.closeTextReplaceModal) {
                            window.JSCEventManager.closeTextReplaceModal();
                        }
                    }
                });
            }

            // ESC í‚¤ë¡œ í…ìŠ¤íŠ¸ êµì²´ ëª¨ë‹¬ ë‹«ê¸°
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && textReplaceModal && textReplaceModal.classList.contains('active')) {
                    if (window.JSCEventManager && window.JSCEventManager.closeTextReplaceModal) {
                        window.JSCEventManager.closeTextReplaceModal();
                    }
                }
            });
        });
    </script>
</body>
</html> 