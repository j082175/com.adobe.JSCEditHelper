<!DOCTYPE html>
<html>
<head>
    <title>ì§„ì§œ ë™ì‘í•˜ëŠ”ì§€ ì¦ëª…</title>
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', monospace; padding: 20px; }
        .console { background: #001100; border: 1px solid #0f0; padding: 20px; margin: 10px 0; border-radius: 5px; min-height: 200px; }
        .success { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        button { background: #0f0; color: #000; border: none; padding: 10px; margin: 5px; font-weight: bold; }
        h1 { text-align: center; color: #0f0; text-shadow: 0 0 10px #0f0; }
    </style>
</head>
<body>
    <h1>ğŸ’€ ì§„ì§œ ë™ì‘í•˜ëŠ”ì§€ ì¦ëª…í•˜ëŠ” í˜ì´ì§€ ğŸ’€</h1>
    
    <button onclick="proveItWorks()">ğŸ”¥ ì¦ëª…í•˜ê¸°</button>
    <button onclick="breakSomething()">ğŸ’¥ ë­”ê°€ ë§ê°€ëœ¨ë ¤ë³´ê¸°</button>
    <button onclick="addNewStuff()">â• ìƒˆ ê¸°ëŠ¥ ì¶”ê°€í•´ë³´ê¸°</button>
    
    <div class="console" id="console"></div>

    <!-- ëª¨ë“  ëª¨ë“ˆ ë¡œë“œ -->
    <script src="js/dependency-injection.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/state-manager.js"></script>
    <script src="js/communication.js"></script>
    <script src="js/event-manager.js"></script>
    <script src="js/error-handler.js"></script>
    <script src="js/sound-engine.js"></script>
    <script src="js/audio-file-processor.js"></script>
    <script src="js/clip-time-calculator.js"></script>
    <script src="js/app.js"></script>

    <script>
        let console_div = document.getElementById('console');
        
        function log(message, type = 'success') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#f00' : type === 'warning' ? '#ff0' : '#0f0';
            console_div.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            console_div.scrollTop = console_div.scrollHeight;
            console.log(message);
        }
        
        function proveItWorks() {
            log("=== ğŸ”¥ ì§„ì§œ ë™ì‘í•˜ëŠ”ì§€ ì¦ëª… ì‹œì‘ ===", 'warning');
            
            try {
                // 1. ëª¨ë“  ëª¨ë“ˆì´ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
                const modules = ['DI', 'JSCUtils', 'JSCUIManager', 'JSCStateManager', 'JSCCommunication', 'JSCEventManager', 'SoundEngine'];
                let loadedCount = 0;
                
                modules.forEach(module => {
                    if (window[module]) {
                        log(`âœ… ${module} ë¡œë“œë¨`);
                        loadedCount++;
                    } else {
                        log(`âŒ ${module} ë¡œë“œ ì•ˆë¨`, 'error');
                    }
                });
                
                log(`ğŸ“Š ëª¨ë“ˆ ë¡œë“œ ê²°ê³¼: ${loadedCount}/${modules.length}`);
                
                // 2. ì‹¤ì œ ê¸°ëŠ¥ í˜¸ì¶œí•´ë³´ê¸°
                if (window.JSCUtils) {
                    window.JSCUtils.debugLog("ì§„ì§œ utils í•¨ìˆ˜ í˜¸ì¶œë¨!");
                    log("âœ… JSCUtils.debugLog() ì‹¤ì œ í˜¸ì¶œ ì„±ê³µ");
                    
                    const isValid = window.JSCUtils.isValidPath("C:\\test");
                    log(`âœ… JSCUtils.isValidPath() ê²°ê³¼: ${isValid}`);
                }
                
                // 3. DI ì»¨í…Œì´ë„ˆ ë™ì‘ í™•ì¸
                if (window.DI) {
                    // ì„œë¹„ìŠ¤ ë“±ë¡
                    window.DI.register('TestService', () => ({ test: () => 'DI ë™ì‘í•¨!' }));
                    log("âœ… DI ì»¨í…Œì´ë„ˆì— í…ŒìŠ¤íŠ¸ ì„œë¹„ìŠ¤ ë“±ë¡");
                    
                    // ì„œë¹„ìŠ¤ ì¡°íšŒ
                    const testService = window.DI.get('TestService');
                    if (testService) {
                        const result = testService.test();
                        log(`âœ… DI ì„œë¹„ìŠ¤ ì¡°íšŒ ë° í˜¸ì¶œ: ${result}`);
                    }
                    
                    // ê¸°ì¡´ ì„œë¹„ìŠ¤ ì¡°íšŒ
                    const utils = window.DI.get('JSCUtils');
                    if (utils === window.JSCUtils) {
                        log("âœ… DIì™€ Legacy ë°©ì‹ì´ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜ - ì™„ë²½!");
                    } else {
                        log("âš ï¸ DIì™€ Legacyê°€ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ - fallback ë™ì‘", 'warning');
                    }
                }
                
                // 4. SoundEngine ìƒíƒœ í™•ì¸
                if (window.SoundEngine) {
                    const status = window.SoundEngine.getEngineStatus();
                    log(`âœ… SoundEngine ìƒíƒœ: ì¤€ë¹„=${status.isReady}, ì˜ì¡´ì„±=${status.dependencies.length}ê°œ`);
                    
                    if (window.SoundEngine.getDIStatus) {
                        const diStatus = window.SoundEngine.getDIStatus();
                        log(`âœ… SoundEngine DI ìƒíƒœ: ${diStatus.isDIAvailable ? 'DI í™œì„±' : 'Legacy ëª¨ë“œ'}`);
                    }
                }
                
                // 5. ì‹¤ì œ UI ìƒí˜¸ì‘ìš©
                if (window.JSCUIManager) {
                    window.JSCUIManager.updateStatus("í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€", true);
                    log("âœ… JSCUIManager.updateStatus() ì‹¤ì œ í˜¸ì¶œë¨");
                }
                
                // 6. ìƒíƒœ ì €ì¥/ë¡œë“œ í…ŒìŠ¤íŠ¸
                if (window.JSCStateManager) {
                    const saved = window.JSCStateManager.saveFolderPath("C:\\test\\folder");
                    log(`âœ… JSCStateManager.saveFolderPath() ê²°ê³¼: ${saved}`);
                    
                    const loaded = window.JSCStateManager.getCurrentFolderPath();
                    log(`âœ… JSCStateManager.getCurrentFolderPath() ê²°ê³¼: ${loaded}`);
                }
                
                log("=== ğŸ‰ ëª¨ë“  ê¸°ëŠ¥ì´ ì‹¤ì œë¡œ ë™ì‘í•©ë‹ˆë‹¤! ===", 'success');
                
            } catch (e) {
                log(`ğŸ’¥ ì˜¤ë¥˜ ë°œìƒ: ${e.message}`, 'error');
                log(`ìŠ¤íƒ: ${e.stack}`, 'error');
            }
        }
        
        function breakSomething() {
            log("=== ğŸ’¥ ë­”ê°€ ë§ê°€ëœ¨ë ¤ë³´ê¸° ===", 'warning');
            
            try {
                // DI ì»¨í…Œì´ë„ˆë¥¼ ì¼ì‹œì ìœ¼ë¡œ ì œê±°
                const originalDI = window.DI;
                window.DI = null;
                log("ğŸ—‘ï¸ DI ì»¨í…Œì´ë„ˆ ì œê±°í•¨");
                
                // ê¸°ì¡´ ê¸°ëŠ¥ë“¤ì´ ì—¬ì „íˆ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸
                if (window.JSCUtils) {
                    window.JSCUtils.debugLog("DI ì—†ì–´ë„ ë™ì‘í•¨!");
                    log("âœ… DI ì—†ì–´ë„ JSCUtils ì •ìƒ ë™ì‘");
                } else {
                    log("âŒ JSCUtils ë™ì‘ ì•ˆí•¨", 'error');
                }
                
                if (window.JSCUIManager) {
                    window.JSCUIManager.updateStatus("DI ì—†ì´ë„ ë™ì‘", true);
                    log("âœ… DI ì—†ì–´ë„ JSCUIManager ì •ìƒ ë™ì‘");
                }
                
                // DI ë³µì›
                window.DI = originalDI;
                log("ğŸ”„ DI ì»¨í…Œì´ë„ˆ ë³µì›");
                
                // ë³µì› í›„ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸
                if (window.DI && window.DI.get('JSCUtils')) {
                    log("âœ… DI ë³µì› í›„ ì •ìƒ ë™ì‘");
                }
                
                log("=== ğŸ›¡ï¸ Fallback ë©”ì»¤ë‹ˆì¦˜ì´ ì™„ë²½í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤! ===", 'success');
                
            } catch (e) {
                log(`ğŸ’¥ ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜: ${e.message}`, 'error');
            }
        }
        
        function addNewStuff() {
            log("=== â• ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹œë®¬ë ˆì´ì…˜ ===", 'warning');
            
            try {
                // 1. ìƒˆë¡œìš´ ImageProcessor ëª¨ë“ˆ ìƒì„±
                window.ImageProcessor = (function() {
                    const utils = window.DI?.get('JSCUtils') || window.JSCUtils;
                    const ui = window.DI?.get('JSCUIManager') || window.JSCUIManager;
                    
                    function processImage(imagePath) {
                        if (!utils) return { success: false, message: 'Utils ì—†ìŒ' };
                        
                        const isValid = utils.isValidPath(imagePath);
                        const result = {
                            success: isValid,
                            message: isValid ? `ì´ë¯¸ì§€ ì²˜ë¦¬ ì™„ë£Œ: ${imagePath}` : 'ì˜ëª»ëœ ê²½ë¡œ',
                            processedAt: new Date().toISOString()
                        };
                        
                        if (ui) {
                            ui.updateStatus(result.message, result.success);
                        }
                        
                        return result;
                    }
                    
                    function getDIStatus() {
                        return {
                            isDIAvailable: !!window.DI,
                            dependencies: [
                                utils ? 'JSCUtils (OK)' : 'JSCUtils (Missing)',
                                ui ? 'JSCUIManager (OK)' : 'JSCUIManager (Missing)'
                            ]
                        };
                    }
                    
                    return { processImage, getDIStatus };
                })();
                
                log("âœ… ìƒˆë¡œìš´ ImageProcessor ëª¨ë“ˆ ìƒì„±");
                
                // 2. DI ì»¨í…Œì´ë„ˆì— ë“±ë¡
                if (window.DI) {
                    window.DI.register('ImageProcessor', () => window.ImageProcessor);
                    log("âœ… DI ì»¨í…Œì´ë„ˆì— ImageProcessor ë“±ë¡");
                }
                
                // 3. ìƒˆ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
                const imageProcessor = window.DI ? window.DI.get('ImageProcessor') : window.ImageProcessor;
                if (imageProcessor) {
                    const result = imageProcessor.processImage('C:\\\\images\\\\test.jpg');
                    log(`âœ… ImageProcessor í…ŒìŠ¤íŠ¸: ${result.message}`);
                    
                    const diStatus = imageProcessor.getDIStatus();
                    log(`âœ… ImageProcessor DI ìƒíƒœ: ${diStatus.dependencies.join(', ')}`);
                }
                
                // 4. ê¸°ì¡´ ê¸°ëŠ¥ë“¤ì´ ì—¬ì „íˆ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸
                if (window.JSCUtils && window.SoundEngine) {
                    window.JSCUtils.debugLog("ìƒˆ ëª¨ë“ˆ ì¶”ê°€ í›„ì—ë„ ê¸°ì¡´ ê¸°ëŠ¥ ë™ì‘");
                    const soundStatus = window.SoundEngine.getEngineStatus();
                    log(`âœ… ê¸°ì¡´ SoundEngine ì—¬ì „íˆ ë™ì‘: ì¤€ë¹„=${soundStatus.isReady}`);
                }
                
                // 5. ìƒˆ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ì‹œë®¬ë ˆì´ì…˜
                const newButton = document.createElement('button');
                newButton.textContent = 'ìƒˆ ì´ë¯¸ì§€ ì²˜ë¦¬ ë²„íŠ¼';
                newButton.onclick = () => {
                    const result = imageProcessor.processImage('C:\\\\new\\\\image.png');
                    log(`ğŸ–¼ï¸ ìƒˆ ë²„íŠ¼ í´ë¦­: ${result.message}`);
                };
                document.body.appendChild(newButton);
                log("âœ… ìƒˆ UI ë²„íŠ¼ ì¶”ê°€ë¨");
                
                log("=== ğŸš€ ìƒˆ ê¸°ëŠ¥ì´ ì™„ë²½í•˜ê²Œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! ===", 'success');
                log("ğŸ“ ì¶”ê°€ëœ ë‚´ìš©:", 'warning');
                log("  - ImageProcessor ëª¨ë“ˆ (ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • 0ì¤„)");
                log("  - DI ì»¨í…Œì´ë„ˆ í†µí•©");
                log("  - ê¸°ì¡´ ì„œë¹„ìŠ¤ì™€ ì—°ë™");
                log("  - ìƒˆ UI ìš”ì†Œ");
                log("  - ê¸°ì¡´ ê¸°ëŠ¥ë“¤ 100% ë³´ì¡´");
                
            } catch (e) {
                log(`ğŸ’¥ ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹¤íŒ¨: ${e.message}`, 'error');
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
        window.addEventListener('load', () => {
            setTimeout(() => {
                log("ğŸ’» í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ. ë²„íŠ¼ì„ í´ë¦­í•´ì„œ ì¦ëª…í•´ë³´ì„¸ìš”!");
            }, 500);
        });
    </script>
</body>
</html>